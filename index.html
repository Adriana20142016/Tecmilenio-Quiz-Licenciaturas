description: "Gestiona el capital humano, dise√±a estrategias de capacitaci√≥n y crea ambientes laborales positivos alineando equipos con objetivos organizacionales.",
               employability: "93%",
               duration: "3 a√±os",
               companies: "90% de empresas se preocupan por retenci√≥n de personal",
               areas: "Recursos Humanos, Capacitaci√≥n, Desarrollo Organizacional",
               jobs: ["T√©cnico de reclutamiento", "Especialista de n√≥minas", "Administrador de recursos humanos", "Analista de capital humano", "Gerente de recursos humanos"],
               routes: ["Desarrollo Humano y Bienestar Organizacional", "Gesti√≥n Estrat√©gica del Talento Humano"]
           },
           tecnologia: {
               name: "Ingenier√≠a en Tecnolog√≠a y Transformaci√≥n Digital",
               description: "Lidera proyectos de innovaci√≥n tecnol√≥gica, optimizando procesos mediante soluciones avanzadas como computaci√≥n en la nube y ciencia de datos.",
               employability: "95%",
               duration: "3 a√±os",
               companies: "149 millones de nuevos puestos digitales previstos para 2025",
               areas: "Transformaci√≥n Digital, Cloud Computing, Ciberseguridad, Ciencia de Datos",
               jobs: ["Consultor en Transformaci√≥n Digital", "Gestor de Proyectos de TI", "Arquitecto de soluciones cloud", "Ingeniero en Seguridad Inform√°tica"],
               routes: ["Transformaci√≥n digital", "Computaci√≥n en la nube", "Ciencia de datos", "Seguridad Inform√°tica", "Sistemas Inform√°ticos de Gesti√≥n"]
           }
       };

       // Variables del quiz
       let currentQuestion = 0;
       let scores = {
           administracion: 0,
           mercadotecnia: 0,
           derecho: 0,
           educacion: 0,
           industrial: 0,
           software: 0,
           comercio: 0,
           talento: 0,
           tecnologia: 0
       };

       // Funci√≥n para enviar datos a Google Sheets
       async function sendToGoogleSheets(data) {
           try {
               const response = await fetch(GOOGLE_SHEETS_URL, {
                   method: 'POST',
                   mode: 'no-cors',
                   headers: {
                       'Content-Type': 'application/json',
                   },
                   body: JSON.stringify(data)
               });
               
               console.log('‚úÖ Datos enviados a Google Sheets');
               return true;
           } catch (error) {
               console.error('‚ùå Error enviando a Google Sheets:', error);
               return false;
           }
       }

       // Manejo del formulario inicial
       document.getElementById('user-form').addEventListener('submit', async function(e) {
           e.preventDefault();
           
           if (validateForm()) {
               // Guardar datos del usuario (NO enviar a√∫n a Google Sheets)
               userData = {
                   nombre: document.getElementById('nombre').value,
                   telefono: document.getElementById('telefono').value,
                   email: document.getElementById('email').value,
                   promedio: document.getElementById('promedio').value,
                   empresa: document.getElementById('empresa').value,
                   inversion: document.getElementById('inversion').value,
                   promotora: promotora,
                   fecha: new Date().toLocaleDateString('es-MX'),
                   hora: new Date().toLocaleTimeString('es-MX')
               };
               
               // Mostrar loading (simulado)
               document.getElementById('loading-message').style.display = 'block';
               setTimeout(() => {
                   document.getElementById('loading-message').style.display = 'none';
                   
                   // Ocultar formulario y mostrar quiz
                   document.getElementById('form-section').classList.add('hidden');
                   document.getElementById('quiz-section').classList.remove('hidden');
                   document.getElementById('quiz-section').classList.add('fade-in');
                   
                   // Mostrar primera pregunta
                   showQuestion();
               }, 1000);
           }
       });

       function validateForm() {
           let isValid = true;
           
           // Limpiar errores previos
           document.querySelectorAll('.error-message').forEach(error => error.textContent = '');
           
           // Validar nombre
           const nombre = document.getElementById('nombre').value.trim();
           if (!nombre) {
               document.getElementById('nombre-error').textContent = 'El nombre es obligatorio';
               isValid = false;
           }
           
           // Validar tel√©fono
           const telefono = document.getElementById('telefono').value.trim();
           if (!telefono || !/^[0-9]{10}$/.test(telefono)) {
               document.getElementById('telefono-error').textContent = 'Ingresa un tel√©fono v√°lido de 10 d√≠gitos';
               isValid = false;
           }
           
           // Validar email
           const email = document.getElementById('email').value.trim();
           if (!email || !email.includes('@')) {
               document.getElementById('email-error').textContent = 'Ingresa un correo v√°lido con @';
               isValid = false;
           }
           
           // Validar promedio (m√°s flexible)
           const promedio = document.getElementById('promedio').value.trim();
           if (!promedio) {
               document.getElementById('promedio-error').textContent = 'Ingresa tu promedio acad√©mico';
               isValid = false;
           }
           
           // Validar empresa (ahora obligatoria)
           const empresa = document.getElementById('empresa').value.trim();
           if (!empresa) {
               document.getElementById('empresa-error').textContent = 'El nombre de la empresa es obligatorio';
               isValid = false;
           }
           
           // Validar inversi√≥n
           if (!document.getElementById('inversion').value) {
               document.getElementById('inversion-error').textContent = 'Selecciona tu rango de inversi√≥n';
               isValid = false;
           }
           
           return isValid;
       }

       function showQuestion() {
           const question = questions[currentQuestion];
           
           // Actualizar n√∫mero de pregunta y texto
           document.getElementById('question-number').textContent = currentQuestion + 1;
           document.getElementById('question-text').textContent = question.text;
           
           // Actualizar barra de progreso
           const progress = ((currentQuestion + 1) / questions.length) * 100;
           document.getElementById('progress-fill').style.width = progress + '%';
           
           // Generar opciones
           const optionsContainer = document.getElementById('options-container');
           optionsContainer.innerHTML = '';
           
           question.options.forEach((option, index) => {
               const optionElement = document.createElement('div');
               optionElement.className = 'option';
               optionElement.textContent = option.text;
               optionElement.addEventListener('click', () => selectOption(index));
               optionsContainer.appendChild(optionElement);
           });
           
           // Deshabilitar bot√≥n siguiente
           document.getElementById('next-btn').disabled = true;
       }

       function selectOption(optionIndex) {
           // Remover selecci√≥n previa
           document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
           
           // Seleccionar nueva opci√≥n
           document.querySelectorAll('.option')[optionIndex].classList.add('selected');
           
           // Guardar selecci√≥n
           window.selectedOption = optionIndex;
           
           // Habilitar bot√≥n siguiente
           document.getElementById('next-btn').disabled = false;
       }

       function nextQuestion() {
           // Procesar respuesta
           if (window.selectedOption !== undefined) {
               const question = questions[currentQuestion];
               const selectedAnswer = question.options[window.selectedOption];
               
               // Sumar puntos
               for (const career in selectedAnswer.scores) {
                   scores[career] += selectedAnswer.scores[career];
               }
           }
           
           // Siguiente pregunta o mostrar resultados
           currentQuestion++;
           
           if (currentQuestion < questions.length) {
               showQuestion();
           } else {
               showResults();
           }
           
           // Resetear selecci√≥n
           window.selectedOption = undefined;
       }

       async function showResults() {
           // Mostrar todos los puntajes para debug
           console.log('üîç DEBUG - Puntajes detallados:');
           for (const career in scores) {
               console.log(`${career}: ${scores[career]} puntos`);
           }
           
           // Ordenar carreras por puntuaci√≥n (de mayor a menor)
           const sortedCareers = Object.keys(scores)
               .map(career => ({ name: career, score: scores[career] }))
               .sort((a, b) => b.score - a.score);
           
           const winningCareer = sortedCareers[0].name;
           const maxScore = sortedCareers[0].score;
           const secondCareer = sortedCareers[1];
           
           console.log('üìä Ranking completo de carreras:', sortedCareers);
           
           // Determinar si hay una segunda carrera cercana (diferencia m√°xima de 6 puntos)
           let showSecondCareer = false;
           let secondCareerName = '';
           
           console.log('üîç Verificando segunda carrera:');
           console.log('- Primera carrera:', winningCareer, 'con', maxScore, 'puntos');
           console.log('- Segunda carrera:', secondCareer ? secondCareer.name : 'No hay', 'con', secondCareer ? secondCareer.score : 0, 'puntos');
           
           if (secondCareer && secondCareer.score > 0) {
               const difference = maxScore - secondCareer.score;
               console.log('- Diferencia:', difference, 'puntos');
               console.log('- ¬øDiferencia <= 6?:', difference <= 6);
               
               if (difference <= 6) {
                   showSecondCareer = true;
                   secondCareerName = secondCareer.name;
                   console.log('‚úÖ SE MUESTRA segunda carrera:', secondCareerName);
               } else {
                   console.log('‚ùå NO se muestra segunda carrera (diferencia muy grande)');
               }
           } else {
               console.log('‚ùå NO hay segunda carrera v√°lida');
           }
           
           // Enviar resultados COMPLETOS a Google Sheets (UNA SOLA VEZ)
           const resultData = {
               timestamp: new Date().toLocaleString('es-MX'),
               promotora: promotoras[promotora].nombre,
               ref: promotora,
               nombre: userData.nombre,
               telefono: userData.telefono,
               email: userData.email,
               promedio: userData.promedio,
               empresa: userData.empresa,
               inversion: userData.inversion, // ‚úÖ PRESUPUESTO AGREGADO
               resultado: showSecondCareer ? 
                   `Principal: ${careers[winningCareer].name} | Secundaria: ${careers[secondCareerName].name}` : 
                   careers[winningCareer].name,
               tipo: 'Quiz Carreras - Completado',
               respuestas: `Principal: ${careers[winningCareer].name} (${maxScore} pts)${showSecondCareer ? ` | Secundaria: ${careers[secondCareerName].name} (${secondCareer.score} pts)` : ''} | Puntajes: ${JSON.stringify(scores)}`
           };
           
           await sendToGoogleSheets(resultData);
           
           // Informaci√≥n de la carrera principal
           const career = careers[winningCareer];
           const secondCareerInfo = showSecondCareer ? careers[secondCareerName] : null;
           
           let resultHTML = `
               <div class="career-result">
                   <h3 class="career-title">${career.name}</h3>
                   <p class="career-description">${career.description}</p>
           `;
           
           // Si hay segunda carrera, agregar mensaje
           if (showSecondCareer) {
               console.log('üé® Agregando HTML de segunda carrera...');
               resultHTML += `
                   <div style="background: linear-gradient(135deg, #fff3e0 0%, #f0f7f0 100%); padding: 20px; border-radius: 15px; margin: 20px 0; border: 2px solid #a8d46f;">
                       <h4 style="color: #2E7D7B; margin-bottom: 10px; font-size: 1.1rem;">üéì Tambi√©n podr√≠as considerar:</h4>
                       <h5 style="color: #2E7D7B; font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">${secondCareerInfo.name}</h5>
                       <p style="color: #555; line-height: 1.5; margin-bottom: 10px;">${secondCareerInfo.description}</p>
                       <div style="display: flex; gap: 20px; font-size: 0.9rem;">
                           <span style="color: #2E7D7B;"><strong>Empleabilidad:</strong> ${secondCareerInfo.employability}</span>
                           <span style="color: #2E7D7B;"><strong>Duraci√≥n:</strong> ${secondCareerInfo.duration}</span>
                       </div>
                       <p style="color: #666; font-style: italic; margin-top: 10px; font-size: 0.9rem;">Ambas carreras coinciden con tu perfil y preferencias</p>
                   </div>
               `;
           } else {
               console.log('‚ùå NO se agrega HTML de segunda carrera');
           }
           
           resultHTML += `
                   <div class="career-stats">
                       <div class="stat-item">
                           <div class="stat-number">${career.employability}</div>
                           <div class="stat-label">Empleabilidad</div>
                       </div>
                       <div class="stat-item">
                           <div class="stat-number">${career.duration}</div>
                           <div class="stat-label">Duraci√≥n</div>
                       </div>
                       <div class="stat-item">
                           <div class="stat-number">28</div>
                           <div class="stat-label">Certificados</div>
                       </div>
                       <div class="stat-item">
                           <div class="stat-number">4,000+</div>
                           <div class="stat-label">Alianzas empresariales</div>
                       </div>
                   </div>
                   
                   <div style="background: white; padding: 25px; border-radius: 15px; margin: 25px 0; border: 2px solid #a8d46f;">
                       <h4 style="color: #2E7D7B; margin-bottom: 15px; font-size: 1.2rem;">üéì Beneficios del Modelo MAPS</h4>
                       
                       <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px 0;">
                           <div style="background: #f0f7f0; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #7CB342;">
                               <div style="font-size: 1.3rem; font-weight: 700; color: #2E7D7B;">28</div>
                               <div style="font-size: 0.9rem; color: #555;">Certificados incluidos</div>
                           </div>
                           <div style="background: #f0f7f0; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #7CB342;">
                               <div style="font-size: 1.3rem; font-weight: 700; color: #2E7D7B;">1</div>
                               <div style="font-size: 0.9rem; color: #555;">Estancia empresarial</div>
                           </div>
                           <div style="background: #f0f7f0; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #7CB342;">
                               <div style="font-size: 1.3rem; font-weight: 700; color: #2E7D7B;">7</div>
                               <div style="font-size: 0.9rem; color: #555;">Lengua extranjera</div>
                           </div>
                           <div style="background: #f0f7f0; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #7CB342;">
                               <div style="font-size: 1.3rem; font-weight: 700; color: #2E7D7B;">‚úì</div>
                               <div style="font-size: 0.9rem; color: #555;">Insignias digitales</div>
                           </div>
                       </div>
                       
                       <h4 style="color: #2E7D7B; margin: 20px 0 10px 0; font-size: 1.1rem;">Rutas de enfoque disponibles:</h4>
                       <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                           <ul style="color: #555; line-height: 1.6; margin-left: 20px; margin-bottom: 0;">
                               ${career.routes ? career.routes.map(route => `<li><strong>${route}</strong></li>`).join('') : '<li>Informaci√≥n no disponible</li>'}
                           </ul>
                       </div>
                       
                       <h4 style="color: #2E7D7B; margin: 20px 0 10px 0; font-size: 1.1rem;">Principales √°reas de trabajo:</h4>
                       <p style="color: #555; line-height: 1.6; margin-bottom: 15px;">${career.areas}</p>
                       
                       <h4 style="color: #2E7D7B; margin: 15px 0 10px 0; font-size: 1.1rem;">Oportunidades laborales:</h4>
                       <ul style="color: #555; line-height: 1.6; margin-left: 20px;">
                           ${career.jobs ? career.jobs.map(job => `<li>${job}</li>`).join('') : '<li>Informaci√≥n no disponible</li>'}
                       </ul>
                       
                       <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f0f7f0 100%); padding: 18px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #7CB342;">
                           <strong style="color: #2E7D7B;">‚ú® Modelo MAPS:</strong> 
                           <span style="color: #555;">Certificados bimestrales que se alinean con las demandas reales del mercado laboral + 4,000 alianzas empresariales</span>
                       </div>
                   </div>
               </div>
           `;
           
           document.getElementById('career-result').innerHTML = resultHTML;
           
           // Configurar enlace de WhatsApp con mensaje personalizado
           const promotorInfo = promotoras[promotora];
           let mensaje = `¬°Hola ${promotorInfo.nombre}! Soy *${userData.nombre}*. Complet√© el test de Tecmilenio y mi resultado fue: *${career.name}*`;
           
           if (showSecondCareer) {
               mensaje += `, pero tambi√©n me interesa *${secondCareerInfo.name}*`;
               console.log('üì± WhatsApp con dos carreras:', mensaje);
           } else {
               console.log('üì± WhatsApp con una carrera:', mensaje);
           }
           
           mensaje += `. ¬øPodr√≠as darme informaci√≥n sobre el descuento y el proceso de admisi√≥n?`;
           
           const whatsappUrl = `https://wa.me/${promotorInfo.telefono}?text=${encodeURIComponent(mensaje)}`;
           document.getElementById('whatsapp-link').href = whatsappUrl;
           
           // Ocultar quiz y mostrar resultados
           document.getElementById('quiz-section').classList.add('hidden');
           document.getElementById('results-section').classList.remove('hidden');
           document.getElementById('results-section').classList.add('fade-in');
       }

       // Permitir solo n√∫meros en el campo tel√©fono
       document.getElementById('telefono').addEventListener('input', function(e) {
           e.target.value = e.target.value.replace(/[^0-9]/g, '');
       });
   </script>
</body>
</html> 
